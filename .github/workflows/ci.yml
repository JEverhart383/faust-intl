name: PR Preview Test Runner
# https://docs.github.com/en/actions/reference/events-that-trigger-workflows
on: [issue_comment]
jobs:
  show-event:
    if: ${{github.event.comment.user.login == 'atlas-by-wp-engine[bot]' && contains(github.event.comment.body, ':white_check_mark:')}}
    runs-on: ubuntu-latest
    outputs:
      output1: ${{ steps.regex-match.outputs.event }}
    steps:
      - uses: actions-ecosystem/action-regex-match@v2
        id: regex-match
        with:
          text: ${{ github.event.comment.body }}
          regex: '^\[.*\]\((.*?)\).*\[(.*?)\]\((.*)\)'
        run: echo "event=${{ steps.regex-match.outputs.group2 }}" >> "$GITHUB_OUTPUT"
  echo-url:
    needs: show-event
    runs-on: ubuntu-latest
    steps:
      - env:
          OUTPUT: ${{needs.show-event.outputs.output1}}
        run: echo "$OUTPUT"

